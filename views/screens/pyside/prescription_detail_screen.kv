#:import utils kivy.utils
#:import dp kivy.metrics.dp

<PrescriptionMedicineCard>:
    size_hint_y: None
    height: self.minimum_height
    padding: dp(16)
    spacing: dp(8)
    radius: dp(12)
    elevation: 2
    md_bg_color: 1, 1, 1, 1
    
    BoxLayout:
        orientation: 'vertical'
        spacing: dp(8)
        size_hint_y: None
        height: self.minimum_height
        
        BoxLayout:
            size_hint_y: None
            height: self.minimum_height
            spacing: dp(10)
            
            MDIcon:
                icon: 'pill'
                size_hint: None, None
                size: dp(28), dp(28)
                color: utils.get_color_from_hex('#406D96')
                pos_hint: {'center_y': 0.5}
            
            MDLabel:
                text: root.medicine_name
                font_style: 'H6'
                size_hint_y: None
                height: self.texture_size[1]
                bold: True
                theme_text_color: 'Primary'
        
        BoxLayout:
            orientation: 'vertical'
            spacing: dp(4)
            size_hint_y: None
            height: self.minimum_height
            padding: [dp(36), 0, 0, 0]
            
            MDLabel:
                text: "Liều dùng"
                font_size: sp(13)
                font_name: 'Roboto'
                color: utils.get_color_from_hex('#667085')
                size_hint_y: None
                height: self.texture_size[1]
            
            MDLabel:
                text: root.usage_info
                font_size: sp(16)
                font_name: 'Roboto'
                bold: True
                color: utils.get_color_from_hex('#344054')
                size_hint_y: None
                height: self.texture_size[1]
        
        BoxLayout:
            orientation: 'vertical'
            spacing: dp(4)
            size_hint_y: None
            height: self.minimum_height
            padding: [dp(36), 0, 0, 0]
            
            MDLabel:
                text: "Tổng số lượng"
                font_size: sp(13)
                font_name: 'Roboto'
                color: utils.get_color_from_hex('#667085')
                size_hint_y: None
                height: self.texture_size[1]
            
            MDLabel:
                text: f"{root.total_quantity} viên"
                font_size: sp(16)
                font_name: 'Roboto'
                bold: True
                color: utils.get_color_from_hex('#344054')
                size_hint_y: None
                height: self.texture_size[1]
        
        BoxLayout:
            orientation: 'vertical'
            spacing: dp(4)
            size_hint_y: None
            height: self.minimum_height
            padding: [dp(36), 0, 0, 0]
            
            MDLabel:
                text: "Thời gian điều trị"
                font_size: sp(13)
                font_name: 'Roboto'
                color: utils.get_color_from_hex('#667085')
                size_hint_y: None
                height: self.texture_size[1]
            
            MDLabel:
                text: root.duration
                font_size: sp(16)
                font_name: 'Roboto'
                bold: True
                color: utils.get_color_from_hex('#344054')
                size_hint_y: None
                height: self.texture_size[1]
        
        BoxLayout:
            orientation: 'vertical'
            spacing: dp(4)
            size_hint_y: None
            height: self.minimum_height
            padding: [dp(36), 0, 0, 0]
            
            MDLabel:
                text: "Hướng dẫn sử dụng"
                font_size: sp(13)
                font_name: 'Roboto'
                color: utils.get_color_from_hex('#667085')
                size_hint_y: None
                height: self.texture_size[1]
            
            MDLabel:
                text: root.usage_instruction
                font_size: sp(15)
                font_name: 'Roboto'
                color: utils.get_color_from_hex('#344054')
                size_hint_y: None
                height: self.texture_size[1]
                text_size: self.width, None

<PrescriptionDetailScreen>:
    BoxLayout:
        orientation: 'vertical'
        spacing: dp(16)
        padding: dp(16)
        
        MDTopAppBar:
            title: "Chi tiết đơn thuốc"
            left_action_items: [['arrow-left', lambda x: root.go_back()]]
            right_action_items: [['printer', lambda x: root.print_prescription()], ['share', lambda x: root.share_prescription()]]
            elevation: 0
            md_bg_color: app.theme_cls.primary_color
        
        ScrollView:
            BoxLayout:
                orientation: 'vertical'
                spacing: dp(16)
                size_hint_y: None
                height: self.minimum_height
                padding: dp(16)
                
                MDCard:
                    size_hint_y: None
                    height: dp(120)
                    padding: dp(16)
                    spacing: dp(8)
                    radius: dp(12)
                    elevation: 2
                    
                    BoxLayout:
                        orientation: 'vertical'
                        spacing: dp(8)
                        pos_hint: {'center_y': 0.5}
                        
                        MDLabel:
                            id: prescription_name
                            text: ""
                            font_style: 'H5'
                            size_hint_y: None
                            height: self.texture_size[1]
                            bold: True
                            theme_text_color: 'Primary'
                            halign: 'center'
                            valign: 'middle'
                            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                            text_size: self.width, None
                        
                        MDLabel:
                            id: hospital_name
                            text: ""
                            font_style: 'Body1'
                            size_hint_y: None
                            height: self.texture_size[1]
                            theme_text_color: 'Secondary'
                        
                        MDLabel:
                            id: created_date
                            text: ""
                            font_style: 'Body1'
                            size_hint_y: None
                            height: self.texture_size[1]
                            theme_text_color: 'Secondary'
                        
                        MDChip:
                            id: status_chip
                            text: ""
                            icon: "check-circle"
                            size_hint: None, None
                            size: dp(120), dp(32)
                            pos_hint: {'center_x': 0.5}
                
                MDLabel:
                    text: "Danh sách thuốc"
                    font_style: 'H6'
                    size_hint_y: None
                    height: self.texture_size[1]
                    bold: True
                    theme_text_color: 'Primary'
                    padding: [0, dp(8), 0, dp(8)]
                
                BoxLayout:
                    id: medicines_layout
                    orientation: 'vertical'
                    spacing: dp(16)
                    size_hint_y: None
                    height: self.minimum_height 